(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6cdd9285"],{"04d1":function(t,e,n){var r=n("342f"),c=r.match(/firefox\/(\d+)/i);t.exports=!!c&&+c[1]},"09ec":function(t,e,n){"use strict";var r=n("7a23"),c=function(t){return Object(r["x"])("data-v-5920ba80"),t=t(),Object(r["v"])(),t},a=c((function(){return Object(r["h"])("i",{class:"fas fa-arrow-left"},null,-1)}));function i(t,e,n,c,i,u){var o=Object(r["C"])("AppButton");return Object(r["u"])(),Object(r["e"])(o,{class:"back-button",onClick:u.backHandler},{default:Object(r["I"])((function(){return[a]})),_:1},8,["onClick"])}var u={class:"appButton"};function o(t,e,n,c,a,i){var o=Object(r["C"])("AppLink");return Object(r["u"])(),Object(r["g"])("div",u,[Object(r["j"])(o,{to:n.to},{default:Object(r["I"])((function(){return[Object(r["B"])(t.$slots,"default",{},void 0,!0)]})),_:3},8,["to"])])}var s=n("aac4"),f={components:{AppLink:s["a"]},props:{to:{type:[String,Object],default:"false"},icon:{type:Boolean}}},b=(n("8926"),n("d959")),l=n.n(b);const p=l()(f,[["render",o],["__scopeId","data-v-7b300988"]]);var d=p,v=d,h={components:{AppButton:v},methods:{backHandler:function(){this.$router.back()}}};n("6efd");const m=l()(h,[["render",i],["__scopeId","data-v-5920ba80"]]);var j=m;e["a"]=j},1690:function(t,e,n){},"199d":function(t,e,n){},"402a":function(t,e,n){},"408a":function(t,e,n){var r=n("e330");t.exports=r(1..valueOf)},"4e82":function(t,e,n){"use strict";var r=n("23e7"),c=n("e330"),a=n("59ed"),i=n("7b0b"),u=n("07fa"),o=n("577e"),s=n("d039"),f=n("addb"),b=n("a640"),l=n("04d1"),p=n("d998"),d=n("2d00"),v=n("512c"),h=[],m=c(h.sort),j=c(h.push),O=s((function(){h.sort(void 0)})),g=s((function(){h.sort(null)})),y=b("sort"),S=!s((function(){if(d)return d<70;if(!(l&&l>3)){if(p)return!0;if(v)return v<603;var t,e,n,r,c="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)h.push({k:e+r,v:n})}for(h.sort((function(t,e){return e.v-t.v})),r=0;r<h.length;r++)e=h[r].k.charAt(0),c.charAt(c.length-1)!==e&&(c+=e);return"DGBEFHACIJK"!==c}})),N=O||!g||!y||!S,w=function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:o(e)>o(n)?1:-1}};r({target:"Array",proto:!0,forced:N},{sort:function(t){void 0!==t&&a(t);var e=i(this);if(S)return void 0===t?m(e):m(e,t);var n,r,c=[],o=u(e);for(r=0;r<o;r++)r in e&&j(c,e[r]);f(c,w(t)),n=c.length,r=0;while(r<n)e[r]=c[r++];while(r<o)delete e[r++];return e}})},"512c":function(t,e,n){var r=n("342f"),c=r.match(/AppleWebKit\/(\d+)\./);t.exports=!!c&&+c[1]},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var r=n("e330"),c=n("1d80"),a=n("577e"),i=n("5899"),u=r("".replace),o="["+i+"]",s=RegExp("^"+o+o+"*"),f=RegExp(o+o+"*$"),b=function(t){return function(e){var n=a(c(e));return 1&t&&(n=u(n,s,"")),2&t&&(n=u(n,f,"")),n}};t.exports={start:b(1),end:b(2),trim:b(3)}},"6efd":function(t,e,n){"use strict";n("b928")},7155:function(t,e,n){},8926:function(t,e,n){"use strict";n("199d")},"8a01":function(t,e,n){"use strict";n("402a")},a46c:function(t,e,n){"use strict";n("ac15")},a9e3:function(t,e,n){"use strict";var r=n("83ab"),c=n("da84"),a=n("e330"),i=n("94ca"),u=n("6eeb"),o=n("1a2d"),s=n("7156"),f=n("3a9b"),b=n("d9b5"),l=n("c04e"),p=n("d039"),d=n("241c").f,v=n("06cf").f,h=n("9bf2").f,m=n("408a"),j=n("58a8").trim,O="Number",g=c[O],y=g.prototype,S=c.TypeError,N=a("".slice),w=a("".charCodeAt),D=function(t){var e=l(t,"number");return"bigint"==typeof e?e:I(e)},I=function(t){var e,n,r,c,a,i,u,o,s=l(t,"number");if(b(s))throw S("Cannot convert a Symbol value to a number");if("string"==typeof s&&s.length>2)if(s=j(s),e=w(s,0),43===e||45===e){if(n=w(s,2),88===n||120===n)return NaN}else if(48===e){switch(w(s,1)){case 66:case 98:r=2,c=49;break;case 79:case 111:r=8,c=55;break;default:return+s}for(a=N(s,2),i=a.length,u=0;u<i;u++)if(o=w(a,u),o<48||o>c)return NaN;return parseInt(a,r)}return+s};if(i(O,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var E,k=function(t){var e=arguments.length<1?0:g(D(t)),n=this;return f(y,n)&&p((function(){m(n)}))?s(Object(e),n,k):e},x=r?d(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),A=0;x.length>A;A++)o(g,E=x[A])&&!o(k,E)&&h(k,E,v(g,E));k.prototype=y,y.constructor=k,u(c,O,k)}},ac15:function(t,e,n){},addb:function(t,e,n){var r=n("4dae"),c=Math.floor,a=function(t,e){var n=t.length,o=c(n/2);return n<8?i(t,e):u(t,a(r(t,0,o),e),a(r(t,o),e),e)},i=function(t,e){var n,r,c=t.length,a=1;while(a<c){r=a,n=t[a];while(r&&e(t[r-1],n)>0)t[r]=t[--r];r!==a++&&(t[r]=n)}return t},u=function(t,e,n,r){var c=e.length,a=n.length,i=0,u=0;while(i<c||u<a)t[i+u]=i<c&&u<a?r(e[i],n[u])<=0?e[i++]:n[u++]:i<c?e[i++]:n[u++];return t};t.exports=a},b3c0:function(t,e,n){},b928:function(t,e,n){},bf3f:function(t,e,n){"use strict";n("7155")},d807:function(t,e,n){"use strict";n("b3c0")},d998:function(t,e,n){var r=n("342f");t.exports=/MSIE|Trident/.test(r)},f223:function(t,e,n){"use strict";n.r(e);var r=n("5530"),c=n("1da1"),a=n("3835"),i=(n("96cf"),n("7db0"),n("d3b7"),n("d81d"),n("4de4"),n("7a23")),u=n("5502"),o=n("b824"),s={getCityChineseName:function(t,e){return t.find((function(t){return t.City===e})).CityName},getCurrentRouteBusStops:function(t,e){return t.filter((function(t){return t.RouteUID===e}))},getCurrentRouteEstimateTime:function(t,e){return t.filter((function(t){return t.RouteName.Zh_tw===e}))},getCurrentDirectionBusTime:function(t,e){return t.filter((function(t){return t.Direction===e}))},isCurrentDirectionShape:function(t){var e=t.shapeRouteID,n=t.shapeDirection,r=t.currentRouteID,c=t.currentDirection;return e===r&&"undefined"===String(n)||n===c},isCurrentDirectionStop:function(t){var e=t.estimatedStopName,n=t.estimatedDirection,r=t.currentStopName,c=t.currentDirection;return e===r&&("undefined"===String(n)||n===c)}},f=function(t){return Object(i["x"])("data-v-25e4592b"),t=t(),Object(i["v"])(),t},b={class:"station-name"},l={class:"start-name"},p=f((function(){return Object(i["h"])("div",{class:"station-arrow"},"⇵",-1)})),d={class:"end-name"};function v(t,e,n,r,c,a){return Object(i["u"])(),Object(i["g"])("div",b,[Object(i["h"])("div",l,Object(i["E"])(n.startName||n.endName),1),p,Object(i["h"])("div",d,Object(i["E"])(n.endName),1)])}var h={props:["startName","endName"]},m=(n("a46c"),n("d959")),j=n.n(m);const O=j()(h,[["render",v],["__scopeId","data-v-25e4592b"]]);var g=O,y=g,S={class:"direction"},N=Object(i["i"])(" 前往"),w=Object(i["i"])(" 前往");function D(t,e,n,r,c,a){return Object(i["u"])(),Object(i["g"])("ul",S,[Object(i["h"])("li",{class:Object(i["q"])({active:0===n.currentDirection}),onClick:e[0]||(e[0]=function(t){return n.changeDirection(0)})},[N,Object(i["h"])("span",null,Object(i["E"])(n.startName||n.endName),1)],2),n.startName?(Object(i["u"])(),Object(i["g"])("li",{key:0,class:Object(i["q"])({active:1===n.currentDirection}),onClick:e[1]||(e[1]=function(t){return n.changeDirection(1)})},[w,Object(i["h"])("span",null,Object(i["E"])(n.endName||"無返程"),1)],2)):Object(i["f"])("",!0)])}n("a9e3");var I={props:{currentDirection:{type:Number,required:!0},changeDirection:{type:Function,required:!0},startName:{type:String},endName:{type:String}}};n("8a01");const E=j()(I,[["render",D],["__scopeId","data-v-71367ed3"]]);var k=E,x=k,A=(n("a4d3"),n("e01a"),n("d28b"),n("3ca3"),n("ddb0"),n("d9e2"),n("06c5"));function C(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Object(A["a"])(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,c=function(){};return{s:c,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){u=!0,a=t},f:function(){try{i||null==n["return"]||n["return"]()}finally{if(u)throw a}}}}var _=n("6b75");function R(t){if(Array.isArray(t))return Object(_["a"])(t)}n("a630");function T(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function F(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function B(t){return R(t)||T(t)||Object(A["a"])(t)||F()}n("159b"),n("4e82"),n("99af");var M={class:"stop-detail"},L={props:{stopDetail:{type:Array}},setup:function(t){function e(t){var e=[];return t.forEach((function(t){var r=t.EstimateTime,a=t.PlateNumb,i=t.Estimates,u=t.NextBusTime;if(i&&0!==i.length)e.push.apply(e,B(f(i)));else if(r||0===r){var o=c(r,a);e.push(o)}else if(u&&!r&&!i){var s=n(u,a);s&&e.push(s)}function f(t){var e,r=[],i=C(t);try{for(i.s();!(e=i.n()).done;){var u=e.value,o=u.EstimateTime,s=u.NextBusTime;if(o||0===o){var f=c(o,a);r.push(f);break}if(s){var b=n(s,a);b&&r.push(b);break}}}catch(l){i.e(l)}finally{i.f()}return r}})),0===e.length?[{class:"error",text:"無發車資料"}]:e.sort((function(t,e){return t.time-e.time}));function n(t,e){var n=new Date(t),c=n.getTime();if(c<Date.now())return!1;var a=r(n.getHours()),i=r(n.getMinutes()),u=e||"";return{class:"almost",text:"".concat(u).concat(a,":").concat(i),time:c}}function r(t){return t<10?"0".concat(t):t}function c(t,e){var n=Math.floor(t/60),r=e||"";return t<=0?c("now","抵達"):0===n?c("now","即將到站"):c("almost","".concat(r," ").concat(n,"分鐘"));function c(e,n){return{class:e,text:n,time:t}}}}return function(n,r){return Object(i["u"])(),Object(i["g"])("div",M,[(Object(i["u"])(!0),Object(i["g"])(i["a"],null,Object(i["A"])(e(t.stopDetail),(function(t,e){return Object(i["u"])(),Object(i["g"])("span",{key:"".concat(t.StopID).concat(e),class:Object(i["q"])(t.class)},[Object(i["h"])("p",null,Object(i["E"])(t.text),1)],2)})),128))])}}};n("d807");const q=j()(L,[["__scopeId","data-v-ebcd4540"]]);var P=q,V=P,Z={key:0,class:"bus-result"},G=["onClick"],U={class:"stop-number"},H={class:"stop-status"},z={class:"stop-name"},J={props:{busStops:{type:Array}},setup:function(t){var e=Object(u["c"])(),n=e.state,r=e.commit;function c(t){var e=t.PositionLat,c=t.PositionLon;n.map.OSM.setView([e,c],18),r("SET_MAP_ACTIVE",!0)}return function(e,n){return t.busStops?(Object(i["u"])(),Object(i["g"])("ul",Z,[(Object(i["u"])(!0),Object(i["g"])(i["a"],null,Object(i["A"])(t.busStops,(function(t,e){return Object(i["u"])(),Object(i["g"])("li",{class:"bus-stop",key:t.StopUID,onClick:function(e){return c(t.StopPosition)}},[Object(i["h"])("div",U,Object(i["E"])(e+1),1),Object(i["h"])("div",H,[Object(i["j"])(Object(i["F"])(V),{stopDetail:t.detail},null,8,["stopDetail"])]),Object(i["h"])("div",z,Object(i["E"])(t.StopName.Zh_tw),1)],8,G)})),128))])):Object(i["f"])("",!0)}}};n("bf3f");const $=J;var K=$,X=K,Y=n("09ec"),W={key:0,class:"busDetail"},Q={class:"top"},tt={class:"title"},et={class:"city"},nt={class:"route-name"},rt={props:{city:{type:String,required:!0},route:{type:String,required:!0},id:{type:String,required:!0}},setup:function(t){var e=t,n=Object(u["c"])(),f=n.state,b=n.dispatch,l=Object(i["z"])(0),p=Object(i["z"])(null),d=Object(i["z"])([]),v=Object(i["c"])((function(){var t=d.value.find((function(t){return t.Direction===l.value}));return t.Stops})),h=Object(i["c"])((function(){var t=Object(a["a"])(d.value,2),e=t[0],n=t[1],r=e.Stops[0].StopName.Zh_tw,c=n?n.Stops[0].StopName.Zh_tw:null;return{start:c,end:r}})),m={city:e.city,route:e.route};function j(){return O.apply(this,arguments)}function O(){return O=Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return b("showLoader",!0),t.next=3,g();case 3:return t.next=5,N();case 5:return t.next=7,b("map/setBusStopsMarker",v.value);case 7:return t.next=9,w();case 9:b("showLoader",!1);case 10:case"end":return t.stop()}}),t)}))),O.apply(this,arguments)}function g(){b("bus/fetchEstimatedTimeOfArrival",m).then((function(t){var n=e.route,r=s.getCurrentRouteEstimateTime(t,n);p.value=S(r)}))}function S(t){return v.value.map((function(e){return Object(r["a"])(Object(r["a"])({},e),{},{detail:t.filter((function(t){var n=t.StopName,r=t.Direction;return s.isCurrentDirectionStop({estimatedStopName:n.Zh_tw,estimatedDirection:r,currentStopName:e.StopName.Zh_tw,currentDirection:l.value})}))})}))}function N(){b("bus/fetchBusShape",m).then((function(t){for(var n=0;n<t.length;n++){var r=t[n];if(s.isCurrentDirectionShape({shapeRouteID:r.RouteUID,shapeDirection:r.Direction,currentRouteID:e.id,currentDirection:l.value})){b("map/setBusRouteShape",r);break}}}))}function w(){b("bus/fetchRealTimeOfArrival",m).then((function(t){var e=s.getCurrentDirectionBusTime(t,l.value);b("map/setBusMarker",e)}))}function D(t){return I.apply(this,arguments)}function I(){return I=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(h.value.end){t.next=2;break}return t.abrupt("return");case 2:return l.value=e,t.next=5,j();case 5:window.scrollTo({top:0,behavior:"smooth"});case 6:case"end":return t.stop()}}),t)}))),I.apply(this,arguments)}return Object(i["G"])((function(){return f.map.OSM}),function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:b("showLoader",!0),b("bus/fetchBusStopOfRoute",m).then((function(t){d.value=s.getCurrentRouteBusStops(t,e.id),j()}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),{immediate:!0}),function(e,n){return 0!==d.value.length?(Object(i["u"])(),Object(i["g"])("div",W,[Object(i["h"])("div",Q,[Object(i["h"])("div",tt,[Object(i["j"])(Object(i["F"])(Y["a"])),Object(i["h"])("div",et,Object(i["E"])(Object(i["F"])(s).getCityChineseName(Object(i["F"])(o),t.city)),1),Object(i["h"])("div",nt,[Object(i["h"])("span",null,Object(i["E"])(t.route),1)])]),Object(i["j"])(Object(i["F"])(y),{startName:Object(i["F"])(h).start,endName:Object(i["F"])(h).end},null,8,["startName","endName"]),Object(i["j"])(Object(i["F"])(x),{currentDirection:l.value,changeDirection:D,startName:Object(i["F"])(h).start,endName:Object(i["F"])(h).end},null,8,["currentDirection","startName","endName"])]),Object(i["j"])(Object(i["F"])(X),{busStops:p.value},null,8,["busStops"])])):Object(i["f"])("",!0)}}};n("fc3a");const ct=rt;var at=ct;e["default"]=at},fc3a:function(t,e,n){"use strict";n("1690")}}]);
//# sourceMappingURL=chunk-6cdd9285.ce75a8b8.js.map